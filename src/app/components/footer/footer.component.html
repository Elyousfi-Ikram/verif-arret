<footer class="footer">
  <!-- Image de la carte -->
  <div [class]="'footer-background ' + (!isContentVisible() ? 'map-visible' : 'map-hidden')">
    <!-- Container responsive pour mobile/tablet -->
    <div class="map-section-container">
      <!-- Carte en haut pour mobile/tablet -->
      <div class="carte-container">
        <img src="assets/footer/carte.png" alt="Carte de France" class="carte-france" />
        <!-- Points sur la carte -->
        <div *ngFor="let location of locations; trackBy: trackByLocationId" class="map-point"
          [class.headquarters-point]="location.isHeadquarters"
          [class.selected-point]="selectedLocation()?.id === location.id" [style.--point-x]="location.mapPosition.x"
          [style.--point-y]="location.mapPosition.y" [title]="location.city" (click)="handlePointClick(location)">
          <div class="point-inner"></div>
          <div class="point-ripple"></div>
          <div class="point-label">{{ location.city }}</div>
        </div>
      </div>

      <!-- Liste des implantations avec design am√©lior√© -->
      <div class="address-cards-container">
        <div class="cards-header">
          <h4 class="cards-title">
            <span class="title-icon">üìç</span>
            Nos implantations
            <div class="title-underline"></div>
          </h4>
        </div>

        <div class="address-cards-grid">
          <div *ngFor="let address of locations; let i = index" [id]="'location-' + address.id" class="address-card"
            [class.highlighted]="address.isHeadquarters" [class.selected]="selectedCard() === i"
            [class.highlighted-card]="selectedLocation()?.id === address.id"
            [class.point-selected]="selectedLocation()?.id === address.id" (click)="selectCard(i)"
            [attr.aria-label]="'Bureau de ' + address.city">

            <div class="card-header">
              <div class="city-info">
                <div class="d-flex justify-content-between align-items-center mt-3">
                  <h5 class="city-name">{{ address.city }}</h5>
                  <span><i class="fas fa-chevron-down pe-5"></i></span>
                </div>
                <span class="region-badge" *ngIf="address.isHeadquarters">
                  Si√®ge social
                </span>
              </div>
            </div>

            <div class="card-content" [class.expanded]="selectedCard() === i">
              <div class="address-info">
                <span class="address-icon">üìç</span>
                <p class="address-text">{{ address.address }}</p>
              </div>

              <div class="contact-info">
                <a [href]="getPhoneHref(address.phone)" class="phone-link" (click)="$event.stopPropagation()">
                  <span class="phone-icon">üìû</span>
                  <span class="phone-text">{{ address.displayPhone }}</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bouton emplacement -->
  <div class="toggle-section">
    <button [class]="'btn-emplacement ' + (!isContentVisible() ? 'rotated' : '')" (click)="toggleFooterContent()"
      [attr.aria-label]="isContentVisible() ? 'Afficher la carte' : 'Afficher le contenu'">
      <img src="assets/footer/emplacement.png" alt="emplacement" class="emplacement" />
      <span class="toggle-hint">
        <span class="chevron-icon">‚ñº</span>
      </span>
    </button>
  </div>

  <!-- Contenu du footer -->
  <div [class]="'container ' + (isContentVisible() ? 'content-visible' : 'content-hidden')">
    <div *ngIf="isContentVisible()">
      <div class="footer-content">
        <!-- Section Logo et Description -->
        <div class="footer-section footer-about">
          <div class="footer-header">
            <div class="footer-logo">
              <img src="assets/footer/logo.png" alt="VERIF-ARRET Logo" class="logo" />
              <div class="logo-text">
                <h3>VERIF-ARRET</h3>
                <span class="tagline">Expertise & Discr√©tion</span>
              </div>
            </div>

            <!-- Section Avis d√©plac√©e pour mobile -->
            <div class="footer-reviews-section">
              <div class="reviews-header">
                <h4>Avis Clients <span class="rating-mobile">{{ getFormattedRating() }}/5</span></h4>
                <div class="ig-stars-container">
                  <div class="d-flex gap-1">
                    <span *ngFor="let star of [0,1,2,3,4]; let i = index" class="ig-star ig-star-enhanced"
                      [ngStyle]="getStarStyle(i, averageRating)">‚òÖ</span>
                  </div>
                  <button class="btn-view-all-reviews" (click)="openReviewsModal()">
                    Voir tous les avis ‚Üí
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Description principale -->
        <div class="footer-description-section">
          <p class="footer-description py-4 text-center">
            Votre partenaire de confiance pour la v√©rification d'arr√™ts de travail et maladie.
            Enqu√™tes professionnelles et discr√®tes sur tout le territoire fran√ßais.
          </p>
        </div>
      </div>

      <!-- Section Contact -->
      <div class="footer-section footer-contact">
        <h4><span class="icon-contact"></span>Contact</h4>
        <div class="contact-info">
          <div class="contact-item">
            <a href="tel:+33607257427" class="contact-link">
              <span class="contact-icon">üìû</span>
              <span class="contact-text">06 07 25 74 27</span>
            </a>
          </div>
          <div class="contact-item">
            <span class="contact-link">
              <span class="contact-icon">‚úâÔ∏è</span>
              <span class="contact-text">verifarret@gmail.fr</span>
            </span>
          </div>
          <div class="contact-item">
            <span class="contact-link">
              <span class="contact-icon">üìç</span>
              <span class="contact-text">4 boulevard Louis Tardy, 79000 Niort</span>
            </span>
          </div>
          <div class="contact-item">
            <span class="contact-link">
              <span class="contact-icon">üïí</span>
              <span class="contact-text">Lundi au Samedi : 9h-21h</span>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer bottom -->
  <div *ngIf="isContentVisible()">
    <div class="footer-bottom">
      <div class="footer-copyright">
        <div class="copyright-content">
          <p>&copy; {{ currentYear }} VERIF-ARRET. Tous droits r√©serv√©s.</p>
          <p class="footer-subtitle">
            Enqu√™teur priv√© agr√©√© - Respect de la vie priv√©e - Interventions l√©gales
          </p>
        </div>
        <div class="footer-section footer-legal">
          <div class="footer-legal">
            <button type="button" class="legal-btn" (click)="onLegalClick('mentions')"
              title="Mentions L√©gales VERIF-ARR√äT" aria-label="Mentions L√©gales cabinet g√©n√©alogie">
              Mentions L√©gales
            </button>
            <span class="separator" aria-hidden="true">|</span>
            <button type="button" class="legal-btn" (click)="onLegalClick('confidentialite')"
              title="Politique de Confidentialit√© VERIF-ARR√äT" aria-label="Politique de Confidentialit√© g√©n√©alogiste">
              Politique de Confidentialit√©
            </button>
            <span class="separator" aria-hidden="true">|</span>
            <button type="button" class="legal-btn" (click)="onLegalClick('cookies')"
              title="Politique de Cookies VERIF-ARR√äT" aria-label="Politique de Cookies cabinet g√©n√©alogie">
              Politique de Cookies
            </button>
          </div>
        </div>
      </div>
      <div class="footer-certifications">
        <span class="certification-badge">
          <span class="badge-icon">Agr√©ment C.N.A.P.S (France)</span>
          <span class="badge-number">NUM : AGD ‚Äì 013 ‚Äì 2112 ‚Äì 10 ‚Äì 10 ‚Äì 20130336981</span>
        </span>
        <span class="certification-badge">
          <span class="badge-icon">Agr√©ment C.N.A.P.S (Corse)</span>
          <span class="badge-number">NUM : AUT ‚Äì 02A ‚Äì 2112 ‚Äì 12 ‚Äì 01 ‚Äì 20130349120</span>
        </span>
      </div>
    </div>
  </div>
</footer>

<app-modal></app-modal>